{
  "hash": "2fb2160e2dbfb1e78a6cb87de2f2cd39",
  "result": {
    "markdown": "---\ntitle: \"Data Acquisition\"\nauthor: \"Drew Gilmore\"\n---\n\n\n# Challenge 1\n\n::: {.cell hash='02_data_acquisition_cache/html/plot_8aa4fdd091cda42c943135481c353c5c'}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(httr)\nlibrary(tidyverse)\nlibrary(jsonlite)\nlibrary(DBI)\n\n#query API\nresp_cb <- GET(\"http://api.citybik.es/v2/networks/stadtrad-hamburg\")\n\n#format data\nstation_data <- resp_cb %>% \n  .$content %>% \n  rawToChar() %>% \n  fromJSON()\n\n#create table and filter data\nbike_list <- station_data[[\"network\"]][[\"stations\"]]\nbike_list_tbl <- as_tibble(bike_list)\n\n#filter data further\ncanyon_bike_list <- bike_list_tbl %>%\n  select(name, free_bikes, timestamp, latitude, longitude)\n  \n\n#create and query database\nmydb <- dbConnect(RSQLite::SQLite(), \"my-db.sqlite\")\n#dbWriteTable(mydb, \"canyon_bike_list\", canyon_bike_list)\ncanyon_bike_list_db <- dbGetQuery(mydb, 'SELECT * FROM canyon_bike_list LIMIT 10')\ndbDisconnect(mydb)\n\n#plot\nkable(canyon_bike_list_db, caption = \"StadtRAD Hamburg Bike Availability\" )\n```\n\n::: {.cell-output-display}\nTable: StadtRAD Hamburg Bike Availability\n\n|name                                      | free_bikes|timestamp                   | latitude| longitude|\n|:-----------------------------------------|----------:|:---------------------------|--------:|---------:|\n|U Hallerstraße / Rothenbaumchaussee       |          1|2024-05-16T08:53:22.704000Z | 53.57208|  9.988801|\n|S Reeperbahn / Königstraße                |          6|2024-05-16T08:53:22.687000Z | 53.54950|  9.954934|\n|Lange Reihe / Kirchenallee                |          5|2024-05-16T08:53:22.606000Z | 53.55520| 10.008200|\n|U Klosterstern / Eppendorfer Baum         |         17|2024-05-16T08:53:22.798000Z | 53.58201|  9.987613|\n|U Horner Rennbahn / Meurerweg             |          4|2024-05-16T08:53:23.013000Z | 53.55419| 10.085077|\n|Bredowstraße / Pinkertweg                 |          4|2024-05-16T08:53:23.016000Z | 53.52691| 10.079240|\n|U Habichtstraße / Steilshooper Straße     |         10|2024-05-16T08:53:23.026000Z | 53.59373| 10.050640|\n|Moorfleeter Straße / Pinkertweg           |          3|2024-05-16T08:53:23.094000Z | 53.52636| 10.092690|\n|Behrmannplatz / Grelckstraße              |          9|2024-05-16T08:53:22.997000Z | 53.59940|  9.958710|\n|Alphonsstraße / Asklepios Klinik Wandsbek |         11|2024-05-16T08:53:23.082000Z | 53.56986| 10.090510|\n:::\n:::\n\n\n# Challenge 2\n\n::: {.cell hash='02_data_acquisition_cache/html/plot2_d5557aa1efaf787673105f1245b250be'}\n\n```{.r .cell-code}\nlibrary(rvest)\nlibrary(tidyverse)\nlibrary(purrr)\nlibrary(xopen)\nlibrary(knitr)\nlibrary(DBI)\n\nurl_home        <- \"https://www.rosebikes.com\"\nhtml_home <- read_html(url_home)\n\n#scrape main navigation elements\nbike_categories_chr2  <- html_home %>% \n      html_element(\"main-navigation.header-main-navigation__main-navigation\") %>% \n  html_elements(\"a\") %>% \n  html_attr(\"href\")\n\n#create urls out of elements\nsite_main_urls <- bike_categories_chr2 |> str_c(\"https://www.rosebikes.com\", ... = _)\n\n#access url for bikes\nsite_category_url <- site_main_urls[1]\nsite_category_html <- read_html(site_category_url)\n\n#scrape bike types\nbike_cats <- site_category_html %>%\n  html_element(\"catalog-navigation\") %>% \n  html_elements(\"a\") %>% \n  html_attr(\"href\")\n\n#create urls for bike types\nbike_cats_subcats <- bike_cats |> str_c(url_home, ... = _)\n\n#access urls for bike types\nsite_subcategory_url <- bike_cats_subcats[2]\nsite_subcategory_html <- read_html(site_subcategory_url)\n\n#scrape bike sub-types\nbike_subcats <- site_subcategory_html %>%\n  html_element(\"catalog-navigation\") %>% \n  html_elements(\"a\") %>% \n  html_attr(\"href\")\n\n#create urls for bike sub-types\nbike_cats_sub_subcats <- bike_subcats |> str_c(url_home, ... = _)\n\n#access bike sub-types\nsite_sub_subcategory_url <- bike_cats_sub_subcats[3]\nsite_sub_subcategory_html <- read_html(site_sub_subcategory_url)\n\n#scrape bike models\nmodel_name <- site_sub_subcategory_html %>% \n  html_elements(\"h4\") %>%\n  html_text2()\n\nmodel_price  <- site_sub_subcategory_html %>%\n       html_elements(\".catalog-category-bikes__price-title\") %>%\n   html_text2() |>\n  str_remove(\"from €\")\n\n#make tibble and plot\nrose_bike_data <- tibble(model   = model_name,\n                    price = model_price)\n\n#query database\nmydb <- dbConnect(RSQLite::SQLite(), \"my-db.sqlite\")\n#dbWriteTable(mydb, \"rose_bike_data\", rose_bike_data)\nrose_bike_data_db <- dbGetQuery(mydb, 'SELECT * FROM rose_bike_data')\ndbDisconnect(mydb)\n\n#plot\nkable(rose_bike_data_db, caption = \"Rose Bikes Endurance Model Pricing\" )\n```\n\n::: {.cell-output-display}\nTable: Rose Bikes Endurance Model Pricing\n\n|model     |price    |\n|:---------|:--------|\n|BLEND     |1,199.00 |\n|REVEAL AL |1,849.00 |\n|PRO SL    |1,099.00 |\n|REVEAL    |3,299.00 |\n:::\n:::\n\nRose endurance road bikes have comparable pricing to the endurance road bikes from Canyon. However, Canyon has a larger inventory of endurance bikes with a higher price range.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}