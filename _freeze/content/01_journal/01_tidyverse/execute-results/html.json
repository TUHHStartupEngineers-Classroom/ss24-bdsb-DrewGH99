{
  "hash": "0884aa18c8824cc90a5de515b28b327c",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Joschka Schwarz/Drew Gilmore\"\n---\n\n\n# Script for Challenges 1 & 2\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_a642b68f4a270f348155bd7b5e10f707'}\n\n```{.r .cell-code}\n#Intro Challenge 1 ----\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(\"magrittr\")\nlibrary(readxl)\nlibrary(readr)\n\n#The following code up to line 68 comes from the content from 'intro to the tidyverse' material. \n\nbikes_tbl      <- read_excel(here(\"00_data/01_raw_data/01_bike_sales/01_raw_data/bikes.xlsx\"), .name_repair = \"unique_quiet\")\norderlines_tbl <- read_excel(here(\"00_data/01_raw_data/01_bike_sales/01_raw_data/orderlines.xlsx\"), .name_repair = \"unique_quiet\")\nbikeshops_tbl  <- read_excel(here(\"00_data/01_raw_data/01_bike_sales/01_raw_data/bikeshops.xlsx\"), .name_repair = \"unique_quiet\")\n\n# Chaining commands with the pipe and assigning it to order_items_joined_tbl\nbike_orderlines_joined_tbl <- orderlines_tbl %>%\n  left_join(bikes_tbl, by = c(\"product.id\" = \"bike.id\")) %>%\n  left_join(bikeshops_tbl, by = c(\"customer.id\" = \"bikeshop.id\"))\n\nbike_orderlines_wrangled_tbl <- bike_orderlines_joined_tbl %>%\n  # 5.1 Separate category name\n  separate(col    = category,\n           into   = c(\"category.1\", \"category.2\", \"category.3\"),\n           sep    = \" - \") %>%\n  \n  # 5.2 Add the total price (price * quantity) \n  # Add a column to a tibble that uses a formula-style calculation of other columns\n  mutate(total.price = price * quantity) %>%\n  \n  # 5.3 Optional: Reorganize. Using select to grab or remove unnecessary columns\n  # 5.3.1 by exact column name\n  select(-...1, -gender) %>%\n  \n  # 5.3.2 by a pattern\n  # You can use the select_helpers to define patterns. \n  # Type ?ends_with and click on Select helpers in the documentation\n  select(-ends_with(\".id\")) %>%\n  \n  # 5.3.3 Actually we need the column \"order.id\". Let's bind it back to the data\n  bind_cols(bike_orderlines_joined_tbl %>% select(order.id)) %>% \n  \n  # 5.3.4 You can reorder the data by selecting the columns in your desired order.\n  # You can use select_helpers like contains() or everything()\n  select(order.id, contains(\"order\"), contains(\"model\"), contains(\"category\"),\n         price, quantity, total.price,\n         everything()) %>%\n  \n  # 5.4 Rename columns because we actually wanted underscores instead of the dots\n  # (one at the time vs. multiple at once)\n  rename(bikeshop = name) %>%\n  set_names(names(.) %>% str_replace_all(\"\\\\.\", \"_\"))\n\n\n\n#create variable for table\nsales_by_location_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n  # separate state and city variables into different columns\n  separate(col   = location,\n           into  = c(\"city\", \"state\"),\n           sep   = \", \") %>%\n \n  #select columns\n  select(state, city, total_price) %>%\n  \n  #Group data by state and sum price data into the 'sales' variable\n    group_by(state) %>% \n      summarize(sales = sum(total_price)) %>%\n\n  \n#add column that formats sales data as a currency\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                   decimal.mark = \",\", \n                                   prefix = \"\", \n                                   suffix = \" €\"))%>% \n\n\n  #Create canvas with x-axis and y-axis values\n  ggplot(aes(x = state, y = sales)) +\n  \n  #Create bar plot with color fill\n  geom_col(fill = \"#9EB6F3\") + \n  \n  #Add labels to bars\n  geom_label(aes(label = sales_text)) + \n  \n  #Scale y-axis\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  \n  #Modify labels and plot title\n  labs(\n    title    = \"Revenue by Location\",\n    subtitle = \"\",\n    x = \"State\", \n    y = \"Revenue\"\n  ) +\n\n  #rotate axis labels\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n#intro challenge 2 ----\n\n#create variable for table\nsales_by_location_and_year_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n  # separate state and city\n  separate(col   = location,\n           into  = c(\"city\", \"state\"),\n           sep   = \", \") %>%\n  \n  select(state, city, total_price, order_date) %>% ##select columns\n  mutate(year = year(order_date)) %>% #add column for the year that takes the year value from the order date\n  group_by(year, state) %>% #group by year and state\n  summarize(sales = sum(total_price), .groups = 'drop') %>% #sum sales for each year and state\n  ungroup() %>% #ungroup\n\n    mutate(sales_text = scales::dollar(sales, big.mark = \".\", #add column that formats sales data as a currency\n                                       decimal.mark = \",\", \n                                       prefix = \"\", \n                                       suffix = \" €\")) %>%\n  \n  ggplot(aes(x = year, y = sales, fill = state)) + #Create canvas with x-axis, y-axis, and fill values\n  \n  geom_col() + #create bar plot\n  \n  geom_smooth(method = \"lm\", se = FALSE) + # Add a trendline\n  \n  facet_wrap(~ state) + #use face wrap to display multiple plots based on state\n  \n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\",    ##Scale y-axis\n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Sales by year and location\",\n    subtitle = \"\",\n    fill = \"Location\"\n  )\n```\n:::\n\n\n## Challenge 1 Result\n\n::: {.cell hash='01_tidyverse_cache/html/plot_7911d4eea482d2f18245afea59b030fe'}\n\n```{.r .cell-code}\nsales_by_location_tbl\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/plot-1.png){width=960}\n:::\n:::\n\n\n## Challenge 2 Result\n\nThe state with the highest revenue is North Rhine-Westphalia.\n\n\n::: {.cell hash='01_tidyverse_cache/html/plot2_268a1ad4444de9933f8bf3519bb8224c'}\n\n```{.r .cell-code}\nsales_by_location_and_year_tbl\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/plot2-1.png){width=960}\n:::\n:::\n\n\n\n::: callout-note\nYou can delete everything in here and start fresh.\n:::\n\nThis is a `.qmd` file. It is plain text with special features. Any time you write just like this, it will be compiled to normal text in the website. If you put a \\# in front of your text, it will create a top level-header.\n\nTo learn more about Quarto websites visit <https://quarto.org/docs/websites>.\n\n# Text Formatting\n\n*italics* and **bold**\n\nsuperscript^2^ / subscript~2~\n\n~~strikethrough~~\n\n`verbatim code`\n\n> Blockquote\n\n# Headings\n\n## Header 2\n### Header 3\n#### Header 4\n##### Header 5\n###### Header 6\n\n# Links & Images\n\n<https://quarto.org>\n\n[Quarto](https://quarto.org)\n\n![Caption](../../assets/img/elephant.png)\n\n[![Caption](../../assets/img/elephant.png)](https://quarto.org)\n\n[![Caption](../../assets/img/elephant.png)](https://quarto.org \"An elephant\")\n\n\n# Lists\n\n* unordered list\n    + sub-item 1\n    + sub-item 2\n        - sub-sub-item 1\n        \n*   item 2\n\n    Continued (indent 4 spaces)\n    \n    \n1. ordered list\n2. item 2\n    i) sub-item 1\n         A.  sub-sub-item 1\n         \n(@)  A list whose numbering\n\ncontinues after\n\n(@)  an interruption\n\n# Tables\n\n| Right | Left | Default | Center |\n|------:|:-----|---------|:------:|\n|   12  |  12  |    12   |    12  |\n|  123  |  123 |   123   |   123  |\n|    1  |    1 |     1   |     1  |\n\n# Source Code\n\nUse ``` to delimit blocks of source code:\n\n```\ncode\n```\n\nAdd a language to syntax highlight code blocks:\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_79db3b60b4ea676b67ec33c9d5c47ea3'}\n\n```{.r .cell-code}\n1 + 1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 2\n```\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_af359e84dd7bbd67d1950e67aa17d2ad'}\n\n```{.r .cell-code}\ncars\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"speed\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"dist\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"2\"},{\"1\":\"4\",\"2\":\"10\"},{\"1\":\"7\",\"2\":\"4\"},{\"1\":\"7\",\"2\":\"22\"},{\"1\":\"8\",\"2\":\"16\"},{\"1\":\"9\",\"2\":\"10\"},{\"1\":\"10\",\"2\":\"18\"},{\"1\":\"10\",\"2\":\"26\"},{\"1\":\"10\",\"2\":\"34\"},{\"1\":\"11\",\"2\":\"17\"},{\"1\":\"11\",\"2\":\"28\"},{\"1\":\"12\",\"2\":\"14\"},{\"1\":\"12\",\"2\":\"20\"},{\"1\":\"12\",\"2\":\"24\"},{\"1\":\"12\",\"2\":\"28\"},{\"1\":\"13\",\"2\":\"26\"},{\"1\":\"13\",\"2\":\"34\"},{\"1\":\"13\",\"2\":\"34\"},{\"1\":\"13\",\"2\":\"46\"},{\"1\":\"14\",\"2\":\"26\"},{\"1\":\"14\",\"2\":\"36\"},{\"1\":\"14\",\"2\":\"60\"},{\"1\":\"14\",\"2\":\"80\"},{\"1\":\"15\",\"2\":\"20\"},{\"1\":\"15\",\"2\":\"26\"},{\"1\":\"15\",\"2\":\"54\"},{\"1\":\"16\",\"2\":\"32\"},{\"1\":\"16\",\"2\":\"40\"},{\"1\":\"17\",\"2\":\"32\"},{\"1\":\"17\",\"2\":\"40\"},{\"1\":\"17\",\"2\":\"50\"},{\"1\":\"18\",\"2\":\"42\"},{\"1\":\"18\",\"2\":\"56\"},{\"1\":\"18\",\"2\":\"76\"},{\"1\":\"18\",\"2\":\"84\"},{\"1\":\"19\",\"2\":\"36\"},{\"1\":\"19\",\"2\":\"46\"},{\"1\":\"19\",\"2\":\"68\"},{\"1\":\"20\",\"2\":\"32\"},{\"1\":\"20\",\"2\":\"48\"},{\"1\":\"20\",\"2\":\"52\"},{\"1\":\"20\",\"2\":\"56\"},{\"1\":\"20\",\"2\":\"64\"},{\"1\":\"22\",\"2\":\"66\"},{\"1\":\"23\",\"2\":\"54\"},{\"1\":\"24\",\"2\":\"70\"},{\"1\":\"24\",\"2\":\"92\"},{\"1\":\"24\",\"2\":\"93\"},{\"1\":\"24\",\"2\":\"120\"},{\"1\":\"25\",\"2\":\"85\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-4_3b57dfda86b9d1f5ca9592ff100a67cc'}\n\n```{.r .cell-code}\nplot(cars)\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}